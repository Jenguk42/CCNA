The Layer 3 header contains information needed to send the packet to its destination
![[Pasted image 20240814093927.png]]

![[Pasted image 20240814093911.png]]
- **Version (4 bits)**
	- Identifies the version of IP used
		- IPv4: 4 (0100 in binary)
		- IPv6: 6 (0110 in binary)
- **IHL - Internet Header Length (4 bits)**
	- Identifies the length of the header in 4 byte increments
		- E.g., Value of 5 = 5\*4 bytes = 20 bytes
	- Can range from 5 to 15
		- Header length ranges from 20 to 60 bytes
	- The final field of the IPv4 header (options) is variable in length, so this field is necessary to indicate the total length of the header
- **DSCP - Differentiated Services Code Point (6 bits)**
	- Used for QoS (Quality of Service)
	- Prioritises delay-sensitive data
- **ECN - Explicit Congestion Notification (2 bits)**
	- Provides end to end notification of network congestion without dropping packets
	- Optional feature that requires both endpoints, as well as the underlying network infrastructure, to support it
- **Total Length (16 bits)**
	- Indicates the total length of the packet (L3 header + L4 segment)
	- Measured in bytes (not 4-byte increments like IHL)
	- Min value is 20 (= IPv4 header with no encapsulated data)
	- Max value is ==65,535==
- **Identification (16 bits)**
	- If a packet is fragmented due to being too large, this field is used to identify which packet the fragment belongs to so that it can be reassembled by the receiving hosts.
	- All fragments of the same packet will have their own IPv4 header with the same value in this field so they can be reassembled later.
	- Packets are fragmented if larger than MTU (Maximum Transmission Unit)
		- MTU is usually 1500 bytes
- **Flags (3 bits)**
	- Used to control/identify fragments
	- Bit 0: Reserved, always set to 0
	- Bit 1: Don't fragment (DF bit), indicates that the packet should not be fragmented
	- Bit 2: More Fragments (MF bit)
		- Set to 1 if there are more fragments in the packet
		- Set to 0 if it is the last fragment
		- Unfragmented packets will always have their MF bit set to 0
- **Fragment Offset (13 bits)**
	- Indicates the position of the fragment within the original, unfragmented IP packet.
	- Allows fragmented packets to be reassembled even if they are out of order
- **TTL (Time to Live) (8 bits)**
	- Indicates a 'hop count' to prevent infinite loop 
		- Each time the packet arrives at a router, the router decreases the TTL by 1
		- A router will drop a packet with a TTL of 0
	- Originally designed to indicate the packet's maximum lifetime in seconds
	- Recommended default TTL of an IPv4 packet = 64
- **Protocol (8 bits)**
	- Indicates the protocol of the encapsulated L4 PDU
	- Value of 6: TCP
	- Value of 17: UDP
	- Value of 1: ICMP
	- Value of 89: OSPF (Dynamic routing protocol)
- **Header Checksum (16 bits)**
	- Used to check for errors only in the IPv4 header
		- When a router receives a packet, it calculates the checksum of the header and compares it to the checksum in this field
		- If they do not match, there was an error in the transmission, so the router drops the packet
	- IP relies on the encapsulated protocol to detect errors in the encapsulated data
		- TCP and UDP have their own checksum fields to detect errors in the encapsulated data.
- **Source & Destination IP Address (32 bits each)**
	- IPv4 addresses of the sender & receiver of the packet [[IPv4 Addressing]]
- **Options (0 to 320 bits)**
	- Optional, rarely used
	- Only present if IHL > 5